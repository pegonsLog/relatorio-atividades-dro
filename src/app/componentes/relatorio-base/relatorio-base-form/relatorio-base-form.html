<form class="row g-3 gy-4" (ngSubmit)="onSubmit()" [formGroup]="form">
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Data</label>
    <input type="date" class="form-control" formControlName="data" #dataInput />
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Dia da Semana</label>
    <input type="text" class="form-control" formControlName="diaSemana" readonly />
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Gerência</label>
    <ng-container *ngIf="isLocked; else gerenciaSelect">
      <input type="text" class="form-control locked-display" [value]="form.get('gerencia')?.value || defaults?.gerencia" readonly />
      <div class="form-text text-muted">Definido pelos filtros</div>
    </ng-container>
    <ng-template #gerenciaSelect>
      <select class="form-select" formControlName="gerencia">
        <option value="" disabled selected>Selecione</option>
        <option value="GARBO">GARBO</option>
        <option value="GARNE">GARNE</option>
        <option value="GARNP">GARNP</option>
        <option value="GARVN">GARVN</option>
        <option value="GEACE">GEACE</option>
        <option value="GAOPE">GAOPE</option>
      </select>
    </ng-template>
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Turno</label>
    <ng-container *ngIf="isLocked; else turnoSelect">
      <input type="text" class="form-control locked-display" [value]="form.get('turno')?.value || defaults?.turno" readonly />
      <div class="form-text text-muted">Definido pelos filtros</div>
    </ng-container>
    <ng-template #turnoSelect>
      <select class="form-select" formControlName="turno">
        <option value="" disabled>Selecione</option>
        <option value="MANHÃ">MANHÃ</option>
        <option value="TARDE">TARDE</option>
        <option value="MADRUGADA">MADRUGADA</option>
      </select>
    </ng-template>
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Mat. 1</label>
    <select class="form-select" formControlName="mat1">
      <option [ngValue]="null" disabled>Selecione</option>
      <option *ngFor="let a of agentes$ | async" [ngValue]="a.matricula">{{ a.matricula }} - {{ a.nome }}</option>
    </select>
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Mat. 2</label>
    <select class="form-select" formControlName="mat2">
      <option [ngValue]="null" disabled>Selecione</option>
      <option *ngFor="let a of agentes$ | async" [ngValue]="a.matricula">{{ a.matricula }} - {{ a.nome }}</option>
    </select>
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Coord.</label>
    <select class="form-select" formControlName="coord">
      <option [ngValue]="null" disabled>Selecione</option>
      <option *ngFor="let a of agentes$ | async" [ngValue]="a.matricula">{{ a.matricula }} - {{ a.nome }}</option>
    </select>
  </div>
  <div class="col-12 col-sm-6 col-md-3">
    <label class="form-label">Superv.</label>
    <select class="form-select" formControlName="superv">
      <option [ngValue]="null" disabled>Selecione</option>
      <option *ngFor="let a of agentes$ | async" [ngValue]="a.matricula">{{ a.matricula }} - {{ a.nome }}</option>
    </select>
  </div>
  <!-- Campos de auditoria (somente leitura) -->
  <div class="col-12" *ngIf="value">
    <div class="row g-3 small text-muted">
      <div class="col-12 col-md-auto">
        <div>Criado em: <span class="fw-semibold">{{ value.createdAt ? (value.createdAt | date:'dd/MM/yyyy HH:mm') : '-' }}</span></div>
      </div>
      <div class="col-12 col-md-auto">
        <div>Criado por: <span class="fw-semibold">{{ value.criadoPor || '-' }}</span></div>
      </div>
      <div class="col-12 col-md-auto">
        <div>Atualizado em: <span class="fw-semibold">{{ value.updatedAt ? (value.updatedAt | date:'dd/MM/yyyy HH:mm') : '-' }}</span></div>
      </div>
      <div class="col-12 col-md-auto">
        <div>Modificado por: <span class="fw-semibold">{{ value.modificadoPor || '-' }}</span></div>
      </div>
    </div>
  </div>
  <div class="col-12 d-flex gap-2">
    <button type="submit" class="btn btn-primary" [disabled]="saving">{{ value?.idRelatorio ? 'Salvar' : 'Salvar' }}</button>
    <button type="button" class="btn btn-outline-secondary" (click)="onCancel()">Cancelar</button>
  </div>
</form>
